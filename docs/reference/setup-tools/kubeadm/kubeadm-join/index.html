<!DOCTYPE html>
<html id="docs" lang="en" class="">
	<head>
	<meta charset="utf-8">
<title>kubeadm join - Kubernetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">
<link rel="stylesheet" type="text/css" href="/css/base_fonts.css">
<link rel="stylesheet" type="text/css" href="/css/styles.css">
<link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
<link rel="stylesheet" type="text/css" href="/css/callouts.css">
<link rel="stylesheet" type="text/css" href="/css/custom-jekyll/tags.css">




<meta name="description" content="kubeadm join" />
<meta property="og:description" content="kubeadm join" />

<meta property="og:url" content="https://kubernetes.io/docs/reference/setup-tools/kubeadm/kubeadm-join/" />
<meta property="og:title" content="kubeadm join - Kubernetes" />

<script
src="https://code.jquery.com/jquery-3.2.1.min.js"
integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
crossorigin="anonymous"></script>
<script
src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


	</head>
	<body>
		<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/docs/home/">Documentation</a></li>
            
            <li><a href="/blog/">Blog</a></li>
            
            <li><a href="/partners/">Partners</a></li>
            
            <li><a href="/community/">Community</a></li>
            
            <li><a href="/case-studies/">Case Studies</a></li>
            
            
             <li>
                <a href="#">
                    English <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/cn/">Chinese</a></li>
                
                </ul>
            </li>
         
            <li>
                <a href="#">
                    v1.11 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io">v1.11</a></li>
                
                    <li><a href="https://kubernetes.io">v1.10</a></li>
                
                    <li><a href="https://v1-9.docs.kubernetes.io">v1.9</a></li>
                
                    <li><a href="https://v1-8.docs.kubernetes.io">v1.8</a></li>
                
                    <li><a href="https://v1-7.docs.kubernetes.io">v1.7</a></li>
                
                </ul>
            </li>
        </ul>
        
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/tutorials/stateless-application/hello-minikube/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/home/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/blog/">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>

		
		
		<section id="hero" class="light-text no-sub">
			















<h1>Reference Documentation</h1>
<h5></h5>


<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/docs/home/">DOCUMENTATION</a></li>
		
		
		<li><a href="/docs/setup/">SETUP</a></li>
		
		
		<li><a href="/docs/concepts/">CONCEPTS</a></li>
		
		
		<li><a href="/docs/tasks/">TASKS</a></li>
		
		
		<li><a href="/docs/tutorials/">TUTORIALS</a></li>
		
		
		<li><a href="/docs/reference/" class="YAH">REFERENCE</a></li>
		
	</ul>
	<div id="searchBox">
		<input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)" autofocus="autofocus">
	</div>
</div>

		</section>
		
		

		<section id="encyclopedia">
			
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
         
        
        <a class="item" data-title="Reference" href="/docs/reference/"></a>

	
	
		
		
<a class="item" data-title="Standardized Glossary" href="/docs/reference/glossary/"></a>

		
	
		
		
	<div class="item" data-title="Kubernetes Issues and Security">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Kubernetes Issue Tracker" href="/docs/reference/issues-security/issues/"></a>

		
	
		
		
<a class="item" data-title="Kubernetes Security and Disclosure Information" href="/docs/reference/issues-security/security/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="Using the Kubernetes API">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Kubernetes API Overview" href="/docs/reference/using-api/api-overview/"></a>

		
	
		
		
<a class="item" data-title="Kubernetes API Concepts" href="/docs/reference/using-api/api-concepts/"></a>

		
	
		
		
<a class="item" data-title="Client Libraries" href="/docs/reference/using-api/client-libraries/"></a>

		
	
		
		
<a class="item" data-title="Kubernetes Deprecation Policy" href="/docs/reference/using-api/deprecation-policy/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="Accessing the API">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Controlling Access to the Kubernetes API" href="/docs/reference/access-authn-authz/controlling-access/"></a>

		
	
		
		
<a class="item" data-title="Authenticating" href="/docs/reference/access-authn-authz/authentication/"></a>

		
	
		
		
<a class="item" data-title="Authenticating with Bootstrap Tokens" href="/docs/reference/access-authn-authz/bootstrap-tokens/"></a>

		
	
		
		
<a class="item" data-title="Using Admission Controllers" href="/docs/reference/access-authn-authz/admission-controllers/"></a>

		
	
		
		
<a class="item" data-title="Dynamic Admission Control" href="/docs/reference/access-authn-authz/extensible-admission-controllers/"></a>

		
	
		
		
<a class="item" data-title="Managing Service Accounts" href="/docs/reference/access-authn-authz/service-accounts-admin/"></a>

		
	
		
		
<a class="item" data-title="Authorization Overview" href="/docs/reference/access-authn-authz/authorization/"></a>

		
	
		
		
<a class="item" data-title="Using RBAC Authorization" href="/docs/reference/access-authn-authz/rbac/"></a>

		
	
		
		
<a class="item" data-title="Using ABAC Authorization" href="/docs/reference/access-authn-authz/abac/"></a>

		
	
		
		
<a class="item" data-title="Using Node Authorization" href="/docs/reference/access-authn-authz/node/"></a>

		
	
		
		
<a class="item" data-title="Webhook Mode" href="/docs/reference/access-authn-authz/webhook/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="API Reference">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Well-Known Labels, Annotations and Taints" href="/docs/reference/kubernetes-api/labels-annotations-taints/"></a>

		
	
		
		
<a class="item" data-title="v1.11" href="/docs/reference/kubernetes-api/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="Federation API">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="extensions/v1beta1 Model Definitions" href="/docs/reference/federation/extensions/v1beta1/definitions/"></a>

		
	
		
		
<a class="item" data-title="extensions/v1beta1 Operations" href="/docs/reference/federation/extensions/v1beta1/operations/"></a>

		
	
		
		
<a class="item" data-title="v1 Model Definitions" href="/docs/reference/federation/v1/definitions/"></a>

		
	
		
		
<a class="item" data-title="v1 Operations" href="/docs/reference/federation/v1/operations/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="Setup tools reference">
		<div class="container">
		
		
	
	
		
		
	<div class="item" data-title="Kubeadm">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Overview of kubeadm" href="/docs/reference/setup-tools/kubeadm/kubeadm/"></a>

		
	
		
		
<a class="item" data-title="kubeadm init" href="/docs/reference/setup-tools/kubeadm/kubeadm-init/"></a>

		
	
		
		
<a class="item" data-title="kubeadm join" href="/docs/reference/setup-tools/kubeadm/kubeadm-join/"></a>

		
	
		
		
<a class="item" data-title="kubeadm upgrade" href="/docs/reference/setup-tools/kubeadm/kubeadm-upgrade/"></a>

		
	
		
		
<a class="item" data-title="kubeadm config" href="/docs/reference/setup-tools/kubeadm/kubeadm-config/"></a>

		
	
		
		
<a class="item" data-title="kubeadm reset" href="/docs/reference/setup-tools/kubeadm/kubeadm-reset/"></a>

		
	
		
		
<a class="item" data-title="kubeadm token" href="/docs/reference/setup-tools/kubeadm/kubeadm-token/"></a>

		
	
		
		
<a class="item" data-title="kubeadm version" href="/docs/reference/setup-tools/kubeadm/kubeadm-version/"></a>

		
	
		
		
<a class="item" data-title="kubeadm alpha" href="/docs/reference/setup-tools/kubeadm/kubeadm-alpha/"></a>

		
	
		
		
<a class="item" data-title="Implementation details" href="/docs/reference/setup-tools/kubeadm/implementation-details/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="kubefed">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="kubefed" href="/docs/reference/setup-tools/kubefed/kubefed/"></a>

		
	
		
		
<a class="item" data-title="kubefed options" href="/docs/reference/setup-tools/kubefed/kubefed-options/"></a>

		
	
		
		
<a class="item" data-title="kubefed init" href="/docs/reference/setup-tools/kubefed/kubefed-init/"></a>

		
	
		
		
<a class="item" data-title="kubefed join" href="/docs/reference/setup-tools/kubefed/kubefed-join/"></a>

		
	
		
		
<a class="item" data-title="kubefed unjoin" href="/docs/reference/setup-tools/kubefed/kubefed-unjoin/"></a>

		
	
		
		
<a class="item" data-title="kubefed version" href="/docs/reference/setup-tools/kubefed/kubefed-version/"></a>

		
	

		</div>
	</div>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="Command line tools reference">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="Feature Gates" href="/docs/reference/command-line-tools-reference/feature-gates/"></a>

		
	
		
		
<a class="item" data-title="federation-apiserver" href="/docs/reference/command-line-tools-reference/federation-apiserver/"></a>

		
	
		
		
<a class="item" data-title="federation-controller-manager" href="/docs/reference/command-line-tools-reference/federation-controller-manager/"></a>

		
	
		
		
<a class="item" data-title="Kubelet authentication/authorization" href="/docs/reference/command-line-tools-reference/kubelet-authentication-authorization/"></a>

		
	
		
		
<a class="item" data-title="TLS bootstrapping" href="/docs/reference/command-line-tools-reference/kubelet-tls-bootstrapping/"></a>

		
	
		
		
<a class="item" data-title="cloud-controller-manager" href="/docs/reference/command-line-tools-reference/cloud-controller-manager/"></a>

		
	
		
		
<a class="item" data-title="kube-apiserver" href="/docs/reference/command-line-tools-reference/kube-apiserver/"></a>

		
	
		
		
<a class="item" data-title="kube-controller-manager" href="/docs/reference/command-line-tools-reference/kube-controller-manager/"></a>

		
	
		
		
<a class="item" data-title="kube-proxy" href="/docs/reference/command-line-tools-reference/kube-proxy/"></a>

		
	
		
		
<a class="item" data-title="kube-scheduler" href="/docs/reference/command-line-tools-reference/kube-scheduler/"></a>

		
	
		
		
<a class="item" data-title="kubelet" href="/docs/reference/command-line-tools-reference/kubelet/"></a>

		
	

		</div>
	</div>

		
	
		
		
	<div class="item" data-title="kubectl CLI">
		<div class="container">
		
		
	
	
		
		
<a class="item" data-title="JSONPath Support" href="/docs/reference/kubectl/jsonpath/"></a>

		
	
		
		
<a class="item" data-title="Overview of kubectl" href="/docs/reference/kubectl/overview/"></a>

		
	
		
		
<a class="item" data-title="kubectl" href="/docs/reference/kubectl/kubectl/"></a>

		
	
		
		
<a class="item" data-title="kubectl Cheat Sheet" href="/docs/reference/kubectl/cheatsheet/"></a>

		
	
		
		
<a class="item" data-title="kubectl Commands" href="/docs/reference/kubectl/kubectl-cmds/"></a>

		
	
		
		
<a class="item" data-title="kubectl Usage Conventions" href="/docs/reference/kubectl/conventions/"></a>

		
	
		
		
<a class="item" data-title="kubectl for Docker Users" href="/docs/reference/kubectl/docker-cli-to-kubectl/"></a>

		
	

		</div>
	</div>

		
	
		
		
<a class="item" data-title="Tools" href="/docs/reference/tools/"></a>

		
	






     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 

			<div id="docsContent">
				
<p><a href="/docs/editdocs#docs/reference/setup-tools/kubeadm/kubeadm-join.md" id="editPageButton">Edit This Page</a></p>

<h1>kubeadm join</h1>



<p>This command initializes a Kubernetes worker node and joins it to the cluster.</p>









<ul id="markdown-toc">


























<li><a href="#what-s-next">What's next</a></li>



</ul>


<p>Run this on any machine you wish to join an existing cluster</p>

<h3 id="synopsis">Synopsis</h3>

<p>When joining a kubeadm initialized cluster, we need to establish
bidirectional trust. This is split into discovery (having the Node
trust the Kubernetes Master) and TLS bootstrap (having the Kubernetes
Master trust the Node).</p>

<p>There are 2 main schemes for discovery. The first is to use a shared
token along with the IP address of the API server. The second is to
provide a file - a subset of the standard kubeconfig file. This file
can be a local file or downloaded via an HTTPS URL. The forms are
kubeadm join &ndash;discovery-token abcdef.1234567890abcdef 1.2.3.4:6443,
kubeadm join &ndash;discovery-file path/to/file.conf, or kubeadm join
&ndash;discovery-file <a href="https://url/file.conf" target="_blank">https://url/file.conf</a>. Only one form can be used. If
the discovery information is loaded from a URL, HTTPS must be used.
Also, in that case the host installed CA bundle is used to verify
the connection.</p>

<p>If you use a shared token for discovery, you should also pass the
&ndash;discovery-token-ca-cert-hash flag to validate the public key of the
root certificate authority (CA) presented by the Kubernetes Master. The
value of this flag is specified as &ldquo;<hash-type>:<hex-encoded-value>&rdquo;,
where the supported hash type is &ldquo;sha256&rdquo;. The hash is calculated over
the bytes of the Subject Public Key Info (SPKI) object (as in RFC7469).
This value is available in the output of &ldquo;kubeadm init&rdquo; or can be
calcuated using standard tools. The &ndash;discovery-token-ca-cert-hash flag
may be repeated multiple times to allow more than one public key.</p>

<p>If you cannot know the CA public key hash ahead of time, you can pass
the &ndash;discovery-token-unsafe-skip-ca-verification flag to disable this
verification. This weakens the kubeadm security model since other nodes
can potentially impersonate the Kubernetes Master.</p>

<p>The TLS bootstrap mechanism is also driven via a shared token. This is
used to temporarily authenticate with the Kubernetes Master to submit a
certificate signing request (CSR) for a locally created key pair. By
default, kubeadm will set up the Kubernetes Master to automatically
approve these signing requests. This token is passed in with the
&ndash;tls-bootstrap-token abcdef.1234567890abcdef flag.</p>

<p>Often times the same token is used for both parts. In this case, the
&ndash;token flag can be used instead of specifying each token individually.</p>

<pre><code>kubeadm join [flags]
</code></pre>

<h3 id="options">Options</h3>

<table style="width: 100%; table-layout: fixed;">
  <colgroup>
    <col span="1" style="width: 10px;" />
    <col span="1" />
  </colgroup>
  <tbody>

    <tr>
      <td colspan="2">--config string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">Path to kubeadm config file.</td>
    </tr>

    <tr>
      <td colspan="2">--cri-socket string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Default: "/var/run/dockershim.sock"</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">Specify the CRI socket to connect to.</td>
    </tr>

    <tr>
      <td colspan="2">--discovery-file string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">A file or url from which to load cluster information.</td>
    </tr>

    <tr>
      <td colspan="2">--discovery-token string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">A token used to validate cluster information fetched from the master.</td>
    </tr>

    <tr>
      <td colspan="2">--discovery-token-ca-cert-hash stringSlice</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">For token-based discovery, validate that the root CA public key matches this hash (format: "&lt;type&gt;:&lt;value&gt;").</td>
    </tr>

    <tr>
      <td colspan="2">--discovery-token-unsafe-skip-ca-verification</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">For token-based discovery, allow joining without --discovery-token-ca-cert-hash pinning.</td>
    </tr>

    <tr>
      <td colspan="2">--feature-gates string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">A set of key=value pairs that describe feature gates for various features. Options are:<br/>Auditing=true|false (ALPHA - default=false)<br/>CoreDNS=true|false (default=true)<br/>DynamicKubeletConfig=true|false (ALPHA - default=false)<br/>SelfHosting=true|false (ALPHA - default=false)<br/>StoreCertsInSecrets=true|false (ALPHA - default=false)</td>
    </tr>

    <tr>
      <td colspan="2">-h, --help</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">help for join</td>
    </tr>

    <tr>
      <td colspan="2">--ignore-preflight-errors stringSlice</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">A list of checks whose errors will be shown as warnings. Example: 'IsPrivilegedUser,Swap'. Value 'all' ignores errors from all checks.</td>
    </tr>

    <tr>
      <td colspan="2">--node-name string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">Specify the node name.</td>
    </tr>

    <tr>
      <td colspan="2">--tls-bootstrap-token string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">A token used for TLS bootstrapping.</td>
    </tr>

    <tr>
      <td colspan="2">--token string</td>
    </tr>
    <tr>
      <td></td><td style="line-height: 130%; word-wrap: break-word;">Use this token for both discovery-token and tls-bootstrap-token.</td>
    </tr>

  </tbody>
</table>

<h3 id="the-joining-workflow">The joining workflow</h3>

<p><code>kubeadm join</code> bootstraps a Kubernetes worker node and joins it to the cluster.
This action consists of the following steps:</p>

<ol>
<li><p>kubeadm downloads necessary cluster information from the API server.
By default, it uses the bootstrap token and the CA key hash to verify the
authenticity of that data. The root CA can also be discovered directly via a
file or URL.</p></li>

<li><p>If kubeadm is invoked with <code>--feature-gates=DynamicKubeletConfig</code> enabled,
it first retrieves the kubelet init configuration from the master and writes it to
the disk. When kubelet starts up, kubeadm updates the node <code>Node.spec.configSource</code> property of the node.
See <a href="/docs/tasks/administer-cluster/kubelet-config-file/">Set Kubelet parameters via a config file</a>
and <a href="/docs/tasks/administer-cluster/reconfigure-kubelet/">Reconfigure a Node&rsquo;s Kubelet in a Live Cluster</a>
for more information about Dynamic Kubelet Configuration.</p></li>

<li><p>Once the cluster information is known, kubelet can start the TLS bootstrapping
process.</p></li>
</ol>

<p>The TLS bootstrap uses the shared token to temporarily authenticate
   with the Kubernetes API server to submit a certificate signing request (CSR); by
   default the control plane signs this CSR request automatically.</p>

<ol>
<li>Finally, kubeadm configures the local kubelet to connect to the API
server with the definitive identity assigned to the node.</li>
</ol>

<h3 id="discovering-what-cluster-ca-to-trust">Discovering what cluster CA to trust</h3>

<p>The kubeadm discovery has several options, each with security tradeoffs.
The right method for your environment depends on how you provision nodes and the
security expectations you have about your network and node lifecycles.</p>

<h4 id="token-based-discovery-with-ca-pinning">Token-based discovery with CA pinning</h4>

<p>This is the default mode in Kubernetes 1.8 and above. In this mode, kubeadm downloads
the cluster configuration (including root CA) and validates it using the token
as well as validating that the root CA public key matches the provided hash and
that the API server certificate is valid under the root CA.</p>

<p>The CA key hash has the format <code>sha256:&lt;hex_encoded_hash&gt;</code>. By default, the hash value is returned in the <code>kubeadm join</code> command printed at the end of <code>kubeadm init</code> or in the output of <code>kubeadm token create --print-join-command</code>. It is in a standard format (see <a href="https://tools.ietf.org/html/rfc7469#section-2.4" target="_blank">RFC7469</a>) and can also be calculated by 3rd party tools or provisioning systems. For example, using the OpenSSL CLI:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der <span style="color:#666">2</span>&gt;/dev/null | openssl dgst -sha256 -hex | sed <span style="color:#b44">&#39;s/^.* //&#39;</span></code></pre></div>
<p><strong>Example <code>kubeadm join</code> command:</strong></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubeadm join --discovery-token abcdef.1234567890abcdef --discovery-token-ca-cert-hash sha256:1234..cdef <span style="color:#666">1</span>.2.3.4:6443</code></pre></div>
<p><strong>Advantages:</strong></p>

<ul>
<li><p>Allows bootstrapping nodes to securely discover a root of trust for the
master even if other worker nodes or the network are compromised.</p></li>

<li><p>Convenient to execute manually since all of the information required fits
into a single <code>kubeadm join</code> command that is easy to copy and paste.</p></li>
</ul>

<p><strong>Disadvantages:</strong></p>

<ul>
<li>The CA hash is not normally known until the master has been provisioned,
which can make it more difficult to build automated provisioning tools that
use kubeadm. By generating your CA in beforehand, you may workaround this
limitation though.</li>
</ul>

<h4 id="token-based-discovery-without-ca-pinning">Token-based discovery without CA pinning</h4>

<p><em>This was the default in Kubernetes 1.7 and earlier</em>, but comes with some
important caveats. This mode relies only on the symmetric token to sign
(HMAC-SHA256) the discovery information that establishes the root of trust for
the master. It&rsquo;s still possible in Kubernetes 1.8 and above using the
<code>--discovery-token-unsafe-skip-ca-verification</code> flag, but you should consider
using one of the other modes if possible.</p>

<p><strong>Example <code>kubeadm join</code> command:</strong></p>

<pre><code>kubeadm join --token abcdef.1234567890abcdef --discovery-token-unsafe-skip-ca-verification 1.2.3.4:6443`
</code></pre>

<p><strong>Advantages:</strong></p>

<ul>
<li><p>Still protects against many network-level attacks.</p></li>

<li><p>The token can be generated ahead of time and shared with the master and
worker nodes, which can then bootstrap in parallel without coordination. This
allows it to be used in many provisioning scenarios.</p></li>
</ul>

<p><strong>Disadvantages:</strong></p>

<ul>
<li>If an attacker is able to steal a bootstrap token via some vulnerability,
they can use that token (along with network-level access) to impersonate the
master to other bootstrapping nodes. This may or may not be an appropriate
tradeoff in your environment.</li>
</ul>

<h4 id="file-or-https-based-discovery">File or HTTPS-based discovery</h4>

<p>This provides an out-of-band way to establish a root of trust between the master
and bootstrapping nodes.   Consider using this mode if you are building automated provisioning
using kubeadm.</p>

<p><strong>Example <code>kubeadm join</code> commands:</strong></p>

<ul>
<li><p><code>kubeadm join --discovery-file path/to/file.conf</code> (local file)</p></li>

<li><p><code>kubeadm join --discovery-file https://url/file.conf</code> (remote HTTPS URL)</p></li>
</ul>

<p><strong>Advantages:</strong></p>

<ul>
<li>Allows bootstrapping nodes to securely discover a root of trust for the
master even if the network or other worker nodes are compromised.</li>
</ul>

<p><strong>Disadvantages:</strong></p>

<ul>
<li>Requires that you have some way to carry the discovery information from
the master to the bootstrapping nodes. This might be possible, for example,
via your cloud provider or provisioning tool. The information in this file is
not secret, but HTTPS or equivalent is required to ensure its integrity.</li>
</ul>

<h3 id="securing-more">Securing your installation even more</h3>

<p>The defaults for kubeadm may not work for everyone. This section documents how to tighten up a kubeadm installation
at the cost of some usability.</p>

<h4 id="turning-off-auto-approval-of-node-client-certificates">Turning off auto-approval of node client certificates</h4>

<p>By default, there is a CSR auto-approver enabled that basically approves any client certificate request
for a kubelet when a Bootstrap Token was used when authenticating. If you don&rsquo;t want the cluster to
automatically approve kubelet client certs, you can turn it off by executing this command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ kubectl delete clusterrole kubeadm:node-autoapprove-bootstrap</code></pre></div>
<p>After that, <code>kubeadm join</code> will block until the admin has manually approved the CSR in flight:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ kubectl get csr
NAME                                                   AGE       REQUESTOR                 CONDITION
node-csr-c69HXe7aYcqkS1bKmH4faEnHAWxn6i2bHZ2mD04jZyQ   18s       system:bootstrap:878f07   Pending

$ kubectl certificate approve node-csr-c69HXe7aYcqkS1bKmH4faEnHAWxn6i2bHZ2mD04jZyQ
certificatesigningrequest &#34;node-csr-c69HXe7aYcqkS1bKmH4faEnHAWxn6i2bHZ2mD04jZyQ&#34; approved

$ kubectl get csr
NAME                                                   AGE       REQUESTOR                 CONDITION
node-csr-c69HXe7aYcqkS1bKmH4faEnHAWxn6i2bHZ2mD04jZyQ   1m        system:bootstrap:878f07   Approved,Issued</code></pre></div>
<p>Only after <code>kubectl certificate approve</code> has been run, <code>kubeadm join</code> can proceed.</p>

<h4 id="turning-off-public-access-to-the-cluster-info-configmap">Turning off public access to the cluster-info ConfigMap</h4>

<p>In order to achieve the joining flow using the token as the only piece of validation information, a
 ConfigMap with some data needed for validation of the master&rsquo;s identity is exposed publicly by
default. While there is no private data in this ConfigMap, some users might wish to turn
it off regardless. Doing so will disable the ability to use the <code>--discovery-token</code> flag of the
<code>kubeadm join</code> flow. Here are the steps to do so:</p>

<ul>
<li>Fetch the <code>cluster-info</code> file from the API Server:</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ kubectl -n kube-public get cm cluster-info -o yaml | grep &#34;kubeconfig:&#34; -A11 | grep &#34;apiVersion&#34; -A10 | sed &#34;s/    //&#34; | tee cluster-info.yaml
apiVersion: v1
clusters:
- cluster:
    certificate-authority-data: &lt;ca-cert&gt;
    server: https://&lt;ip&gt;:&lt;port&gt;
  name: &#34;&#34;
contexts: []
current-context: &#34;&#34;
kind: Config
preferences: {}
users: []</code></pre></div>
<ul>
<li><p>Use the <code>cluster-info.yaml</code> file as an argument to <code>kubeadm join --discovery-file</code>.</p></li>

<li><p>Turn off public access to the <code>cluster-info</code> ConfigMap:</p></li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-console" data-lang="console">$ kubectl -n kube-public delete rolebinding kubeadm:bootstrap-signer-clusterinfo</code></pre></div>
<p>These commands should be run after <code>kubeadm init</code> but before <code>kubeadm join</code>.</p>

<h3 id="config-file">Using kubeadm join with a configuration file</h3>

<blockquote class="caution">
  <div><strong>Caution:</strong> The config file is
still considered alpha and may change in future versions.</div>
</blockquote>

<p>It&rsquo;s possible to configure <code>kubeadm join</code> with a configuration file instead of command
line flags, and some more advanced features may only be available as
configuration file options.  This file is passed in the <code>--config</code> option.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>kubeadm.k8s.io/v1alpha1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>NodeConfiguration<span style="color:#bbb">
</span><span style="color:#bbb"></span>caCertPath:<span style="color:#bbb"> </span>&lt;path|string<span style="color:#b44;font-style:italic">&gt;
</span><span style="color:#b44;font-style:italic">discoveryFile: &lt;path|string&gt;
</span><span style="color:#b44;font-style:italic">discoveryToken: &lt;string&gt;
</span><span style="color:#b44;font-style:italic">discoveryTokenAPIServers:
</span><span style="color:#b44;font-style:italic">- &lt;address|string&gt;
</span><span style="color:#b44;font-style:italic">- &lt;address|string&gt;
</span><span style="color:#b44;font-style:italic">nodeName: &lt;string&gt;
</span><span style="color:#b44;font-style:italic">tlsBootstrapToken: &lt;string&gt;
</span><span style="color:#b44;font-style:italic">token: &lt;string&gt;
</span><span style="color:#b44;font-style:italic">discoveryTokenCACertHashes:
</span><span style="color:#b44;font-style:italic">- &lt;SHA-256 hash|string&gt;
</span><span style="color:#b44;font-style:italic">- &lt;SHA-256 hash|string&gt;
</span><span style="color:#b44;font-style:italic">discoveryTokenUnsafeSkipCAVerification: &lt;bool&gt;</span></code></pre></div>











<h2 id="what-s-next">What&#39;s next</h2>
<ul>
<li><a href="/docs/reference/setup-tools/kubeadm/kubeadm-init/">kubeadm init</a> to bootstrap a Kubernetes master node</li>
<li><a href="/docs/reference/setup-tools/kubeadm/kubeadm-token/">kubeadm token</a> to manage tokens for <code>kubeadm join</code></li>
<li><a href="/docs/reference/setup-tools/kubeadm/kubeadm-reset/">kubeadm reset</a> to revert any changes made to this host by <code>kubeadm init</code> or <code>kubeadm join</code></li>
</ul>






				<div class="issue-button-container">
					<p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/reference/setup-tools/kubeadm/kubeadm-join.md?pixel" alt="Analytics" /></a></p>
					
					
					<script type="text/javascript">
					PDRTJS_settings_8345992 = {
					"id" : "8345992",
					"unique_id" : "\/docs\/reference\/setup-tools\/kubeadm\/kubeadm-join\/",
					"title" : "kubeadm join",
					"permalink" : "https:\/\/kubernetes.io\/docs\/reference\/setup-tools\/kubeadm\/kubeadm-join\/"
					};
					(function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
					</script>
					<a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?title=Issue%20with%20' +
					'k8s.io'+window.location.pathname)" class="button issue">Create an Issue</a>
					
					
					
					<a href="/docs/editdocs#docs/reference/setup-tools/kubeadm/kubeadm-join.md" class="button issue">Edit this Page</a>
					
				</div>
			</div>
		</section>
		<footer>
    <main class="light-text">
        <nav>
            
            
            
            <a href="/docs/home/">Documentation</a>
            
            <a href="/blog/">Blog</a>
            
            <a href="/partners/">Partners</a>
            
            <a href="/community/">Community</a>
            
            <a href="/case-studies/">Case Studies</a>
            
        </nav>
        <div class="social">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
            <div>
                <a href="/docs/setup/pick-right-solution/" class="button">Get Kubernetes</a>
                <a href="https://git.k8s.io/community/contributors/guide" class="button">Contribute</a>
            </div>
        </div>
        <div id="miceType" class="center">
            &copy; 2018 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a>
        </div>
        <div id="miceType" class="center">
            Copyright &copy; 2018 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
    </main>
</footer>

		<button class="flyout-button" onclick="kub.toggleToc()"></button>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');


(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



	</body>
</html>